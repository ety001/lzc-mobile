[supervisord]
nodaemon=true
# 将 Supervisor 主进程日志输出到 stdout，由 Docker 日志驱动管理
logfile=/dev/stdout
logfile_maxbytes=0
pidfile=/var/run/supervisord.pid

[program:asterisk]
command=/bin/bash -c "sleep 2 && /usr/sbin/asterisk -f -vvv"
autostart=true
autorestart=true
# 输出到 stdout/stderr，由 Docker 日志驱动管理，不会增加容器体积
# 使用 Docker 的日志驱动（如 json-file）会将日志存储在宿主机上
stderr_logfile=/dev/stderr
stdout_logfile=/dev/stdout
stderr_logfile_maxbytes=0
stdout_logfile_maxbytes=0
user=root
# 确保 webpanel 先启动并渲染配置
priority=100

[program:webpanel]
command=/app/bin/webpanel
autostart=true
autorestart=true
# 输出到 stdout/stderr，由 Docker 日志驱动管理，不会增加容器体积
stderr_logfile=/dev/stderr
stdout_logfile=/dev/stdout
stderr_logfile_maxbytes=0
stdout_logfile_maxbytes=0
user=root
# 确保 webpanel 先启动，以便在 Asterisk 启动前渲染配置
priority=200

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[unix_http_server]
file=/var/run/supervisor.sock

[supervisorctl]
serverurl=unix:///var/run/supervisor.sock
